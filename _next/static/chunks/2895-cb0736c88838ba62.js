"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2895],{31348:function(t,e,o){o.d(e,{m:function(){return r}});var a=o(46860);function r(t,e){return(t?n(t):0)-(e?n(e):0)}function n(t){var e;let o=a.WI.getFiatAmount(t,a.Yw.USD);return null!==(e=null==o?void 0:o.value)&&void 0!==e?e:0}},62895:function(t,e,o){o.d(e,{earnStore:function(){return F}});var a=o(38623),r=o(59533),n=o(50054),i=o(46016),s=o(64770),l=o(31348);let d=new a.gG(1,100).multiply(100001),u=t=>{if(null!=t){if("Infinity"===t)return d;try{let e=(0,a.vz)(t,18),o=BigInt(1e18);return new a.gG(e,o)}catch(t){console.error("Failed to parse percent from API",t);return}}};var p=o(77248);async function c(){let{data:t}=await p.G.overview.farm.all({});return(null==t?void 0:t.map(t=>({id:t.id,chainKey:t.chainKey,address:t.address,apr:u(t.apr),apy:u(t.apy)})))||[]}var v=o(98477),m=o(75016),P=o(10700);async function g(){let{data:t}=await p.G.overview.pool.all({});return(null==t?void 0:t.map(t=>({id:(0,P.T)(t),chainKey:t.chainKey,address:t.address,apr:u(t.apr),apy:u(t.apy),tvlUsd:t.tvlUsd,inboundVolume1dUsd:t.inboundVolume1dUsd,inboundVolume7dUsd:t.inboundVolume7dUsd})))||[]}let h=[{chainKey:"optimism",symbol:"ETH",address:"0xd22363e3762cA7339569F3d33EADe20127D5F98C",supportedBy:"Metis"},{chainKey:"optimism",symbol:"USDC.e",address:"0xDecC0c09c3B5f6e92EF4184125D5648a66E35298",supportedBy:"Optimism"},{chainKey:"avalanche",symbol:"USDT",address:"0xEAe5c2F6B25933deB62f754f239111413A0A25ef",supportedBy:"Metis"},{chainKey:"bsc",symbol:"USDT",address:"0x68C6c27fB0e02285829e69240BE16f32C5f8bEFe",supportedBy:"Metis"},{chainKey:"metis",symbol:"USDT",address:"0x2b60473a7C41Deb80EDdaafD5560e963440eb632",supportedBy:"Metis"},{chainKey:"ethereum",symbol:"USDT",address:"0x430Ebff5E3E80A6C58E7e6ADA1d90F5c28AA116d",supportedBy:"Metis"},{chainKey:"optimism",symbol:"DAI",address:"0x165137624F1f692e69659f944BF69DE02874ee27",supportedBy:"Optimism"},{chainKey:"optimism",symbol:"FRAX",address:"0x368605D9C6243A80903b9e326f1Cddde088B8924",supportedBy:"Optimism"},{chainKey:"base",symbol:"USDC",address:"0x4c80E24119CFB836cdF0a6b53dc23F04F7e652CA"},{chainKey:"avalanche",symbol:"WOO",address:"0x45524dc9d05269E1101Ad7Cff1639AE2aA20989d"}];var y=o(15139);class f{get wallet(){return s.walletStore.evm}get pools(){return y.b.pools}get farms(){return m.K.farms}get myPools(){return this.allPools.filter(t=>{var e,o;return null===(o=t.poolPosition)||void 0===o?void 0:null===(e=o.lpTotal)||void 0===e?void 0:e.greaterThan(0)}).sort(A).reverse()}get topPools(){return this.allPools.slice().sort((t,e)=>{var o,a;return o=t.poolData,a=e.poolData,((null==o?void 0:o.tvlUsd)?Number(o.tvlUsd):0)-((null==a?void 0:a.tvlUsd)?Number(a.tvlUsd):0)}).reverse()}get availablePools(){return this.allPools.filter(t=>{var e,o;return null===(o=t.poolPosition)||void 0===o?void 0:null===(e=o.available)||void 0===e?void 0:e.greaterThan(0)}).sort((t,e)=>{var o,a;return(0,l.m)(null===(o=t.poolPosition)||void 0===o?void 0:o.available,null===(a=e.poolPosition)||void 0===a?void 0:a.available)}).reverse()}get allPools(){return this.poolRows.filter(t=>!t.pool.disabled)}get poolRows(){var t;let e=null===(t=this.wallet)||void 0===t?void 0:t.address;return y.b.pools.map(t=>{var o;let a=e?this.getPoolPosition(t,e):void 0,r=this.getPoolData(t);return{poolMetaData:(o=t,h.find(t=>t.chainKey===o.chainKey&&t.address.toLowerCase()===o.address.toLowerCase())||{symbol:o.token.symbol,address:o.address,chainKey:o.chainKey}),pool:t,poolData:r,poolPosition:a}})}get myFarms(){return this.allFarms.filter(t=>{var e,o;return null===(o=t.farmPosition)||void 0===o?void 0:null===(e=o.depositedAmount)||void 0===e?void 0:e.greaterThan(0)}).sort((t,e)=>{var o,a;return(0,l.m)(null===(o=t.farmPosition)||void 0===o?void 0:o.depositedAmount,null===(a=e.farmPosition)||void 0===a?void 0:a.depositedAmount)}).reverse()}get myFarmsWithoutIncentives(){return this.myFarms.filter(w)}get topFarms(){return this.allFarms.slice().filter(b).sort((t,e)=>{var o,r;return function(t,e){let o=null!=t?t:new a.gG(0n,1),r=null!=e?e:new a.gG(0n,1);return Number(o.subtract(r).toSignificant(4))}(null===(o=t.farmData)||void 0===o?void 0:o.apr,null===(r=e.farmData)||void 0===r?void 0:r.apr)}).reverse()}get availableFarms(){return this.allFarms.filter(t=>{var e,o;return null===(o=t.poolPosition)||void 0===o?void 0:null===(e=o.lpAvailable)||void 0===e?void 0:e.greaterThan(0)}).sort((t,e)=>{var o,a;return(0,l.m)(null===(o=t.poolPosition)||void 0===o?void 0:o.lpAvailable,null===(a=e.poolPosition)||void 0===a?void 0:a.lpAvailable)}).reverse()}get allFarms(){return this.farmRows.filter(t=>!t.farm.disabled).sort(t=>"v2"===t.farm.stargateVersion?1:0)}get farmRows(){var t;let{allPools:e}=this,o=null===(t=this.wallet)||void 0===t?void 0:t.address;return this.farms.map(t=>{let a=this.getFarmData(t),r=o?this.getFarmPosition(t,o):void 0;return{...e.find(e=>e.pool.lpToken.equals(t.lpToken)),farm:t,farmData:a,farmPosition:r}})}async updatePoolData(){let t=await g();(0,r.z)(()=>{this.poolData.length=0,this.poolData.push(...t)})}async updateFarmData(){let t=await c();(0,r.z)(()=>{this.farmData.length=0,this.farmData.push(...t)})}async updatePoolTotalSupply(t){let e=this.getPoolAdapter(t),o=t.lpToken.id,a=await e.getTotalSupply();return await (0,i.z)(()=>{this.poolTotalSupply.set(o,a)}),a}async updatePoolBalance(t,e){return n._.updateBalance(t.lpToken,e)}async updateFarmPosition(t,e){let o=this.getFarmAdapter(t),a=T(t,e),[r,n]=await Promise.all([o.getDepositedAmount({user:e}),o.getPendingRewards({user:e})]),s={depositedAmount:r.amount,rewards:n.rewards.toSorted((t,e)=>{let o=D(t),a=D(e);return o===a?0:o<a?1:-1}),farm:t,user:e};return await (0,i.z)(()=>{this.farmPositions.set(a,s)}),s}getTotalSupply(t){return this.poolTotalSupply.get(t.id)}getFarmData(t){return this.farmData.find(e=>e.id===(0,v._)(t))}getFarmPosition(t,e){return this.farmPositions.get(T(t,e))}getFarmingBalance(t,e){let o=0n;for(let a of this.farms){if(!a.lpToken.equals(t))continue;let r=this.getFarmPosition(a,e);if(!r)return;o+=r.depositedAmount.toBigInt()}return a.ih.fromBigInt(t,o)}getPoolData(t){return this.poolData.find(e=>e.id===(0,P.T)(t))}getPoolPosition(t,e){if(!e)return;let o=n._.getBalance(t.token,e),r=n._.getBalance(t.lpToken,e),i=this.getFarmingBalance(t.lpToken,e),s=i?null==r?void 0:r.add(i):void 0,l=this.getTotalSupply(t.lpToken),d=s&&(null==l?void 0:l.greaterThan(0))?new a.gG(s.toBigInt(),l.toBigInt()):void 0;return{available:o,lpAvailable:r,lpTotal:s,lpLocked:i,poolShare:d}}getPoolAdapter(t){return y.b.getAdapter(t)}getFarmAdapter(t){return m.K.getAdapter(t)}subscribe(){let t=()=>{var t;if(null===(t=this.wallet)||void 0===t?void 0:t.address)for(let t of this.farms)this.updateFarmPosition(t,this.wallet.address)},e=()=>{for(let t of this.pools)this.updatePoolTotalSupply(t)},o=()=>{var t;if(null===(t=this.wallet)||void 0===t?void 0:t.address)for(let t of this.pools)this.updatePoolBalance(t,this.wallet.address)},a=()=>{this.updatePoolData()},n=()=>{this.updateFarmData()},i=[(0,r.EH)(()=>a()),(0,r.EH)(()=>o()),(0,r.EH)(()=>t()),(0,r.EH)(()=>e()),(0,r.EH)(()=>n())];return()=>{i.forEach(t=>t())}}constructor(){this.farmData=r.LO.array([],{deep:!1}),this.poolData=r.LO.array([],{deep:!1}),this.poolTotalSupply=r.LO.map({},{deep:!1}),this.farmPositions=r.LO.map({},{deep:!1}),(0,r.ky)(this,{availablePools:r.Fl.struct,availableFarms:r.Fl.struct,topPools:r.Fl.struct,topFarms:r.Fl.struct,allPools:r.Fl.struct,allFarms:r.Fl.struct,myFarms:r.Fl.struct,myFarmsWithoutIncentives:r.Fl.struct,myPools:r.Fl.struct,wallet:r.Fl,poolRows:r.Fl.struct,farmRows:r.Fl.struct},{autoBind:!0})}}let Z=new a.gG(1,1e3);function b(t){var e,o;return null===(o=t.farmData)||void 0===o?void 0:null===(e=o.apr)||void 0===e?void 0:e.greaterThan(Z)}function w(t){var e,o;return null===(o=t.farmData)||void 0===o?void 0:null===(e=o.apr)||void 0===e?void 0:e.lessThanOrEqualTo(Z)}function T(t,e){return"".concat((0,v._)(t),":").concat(e)}let F=new f;function A(t,e){let{poolPosition:o,pool:r}=t,{poolPosition:n,pool:i}=e,s=(null==o?void 0:o.lpTotal)&&(0,a.ph)(o.lpTotal,r.token),d=(null==n?void 0:n.lpTotal)&&(0,a.ph)(n.lpTotal,i.token);return(0,l.m)(s,d)}function D(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;return t.toBigInt()*BigInt(10**e)/BigInt(10**t.token.decimals)}},98477:function(t,e,o){o.d(e,{_:function(){return a}});function a(t){if("address"in t.lpToken)return"".concat(t.chainKey,":").concat(t.address.toLowerCase(),":").concat(t.lpToken.address.toLowerCase());throw Error("Unsupported farm: ".concat(t.chainKey,":").concat(t.address))}},75016:function(t,e,o){o.d(e,{K:function(){return s}});var a=o(59533),r=o(47542),n=o(98477);class i{getAdapter(t){for(let e of this.adapters)if(e.supports(t))return e;throw Error("Adapter not found for farm ".concat((0,n._)(t)))}constructor(){this.adapters=r.aL,this.farms=r.p3,this.unsubscribe=void 0,(0,a.ky)(this,{},{})}}let s=new i},77248:function(t,e,o){o.d(e,{G:function(){return D}});var a=o(38623),r=o(65720),n=o(41270),i=o(23974);let s=n.ZP.string().nonempty(),l=t=>/^[+-]?\d+(\.\d+)?$/.test(t),d=n.ZP.string().refine(t=>l(t)||"Infinity"===t,{message:"Is not a numeric string"}),u=r.Z.create({baseURL:"".concat(i.O.NEXT_PUBLIC_STARGATE_API_URL,"/v1")}),p=n.ZP.object({sort:n.ZP.string()}),c=n.ZP.object({data:n.ZP.object({tvlUsd:n.ZP.record(s,d),totalVolumeUsd:n.ZP.record(s,d),totalTransactionCount:n.ZP.record(s,d)})}),v=n.ZP.object({data:n.ZP.object({tvlUsd:d,tvlUsd24h:d,totalVolumeUsd24h:d,totalVolumeUsd48h:d,totalTransactionCount24h:d,totalTransactionCount48h:d})}),m=n.ZP.object({data:n.ZP.array(n.ZP.object({stargateVersion:n.ZP.string(),id:n.ZP.string(),chainKey:n.ZP.string(),address:n.ZP.string(),tvlUsd:d,inboundVolume1dUsd:d,inboundVolume7dUsd:d,apr:d.nullish(),apy:d.nullish()}))}),P=n.ZP.object({sort:n.ZP.string(),chainKey:n.ZP.string(),address:n.ZP.string()}),g=n.ZP.object({data:n.ZP.object({tvlUsd:n.ZP.record(s,d),inboundVolumeUsd:n.ZP.record(s,d),inboundTransactionCount:n.ZP.record(s,d)})}),h=n.ZP.object({chainKey:n.ZP.string(),address:n.ZP.string()}),y=n.ZP.object({data:n.ZP.object({tvlUsd:d,tvlUsd24h:d,inboundVolumeUsd24h:d,inboundVolumeUsd48h:d,inboundTransactionCount24h:d,inboundTransactionCount48h:d})}),f=n.ZP.object({srcSymbol:n.ZP.string().optional(),srcPool:n.ZP.string().optional(),srcChainKey:n.ZP.string().optional(),dstSymbol:n.ZP.string().optional(),dstPool:n.ZP.string().optional(),dstChainKey:n.ZP.string().optional(),after:n.ZP.string().datetime().optional(),size:n.ZP.number().optional()}),Z=n.ZP.object({data:n.ZP.array(n.ZP.object({srcChainKey:n.ZP.string(),dstChainKey:n.ZP.string(),srcToken:n.ZP.string(),srcSymbol:n.ZP.string(),dstToken:n.ZP.string(),dstSymbol:n.ZP.string(),srcPool:n.ZP.string(),dstPool:n.ZP.string(),srcAmount:n.ZP.string(),usdValue:n.ZP.string(),srcAddress:n.ZP.string(),srcTxHash:n.ZP.string(),srcTxTimestamp:n.ZP.number(),mode:n.ZP.string()}))}),b=n.ZP.object({srcAddress:n.ZP.string(),start:n.ZP.string().datetime(),end:n.ZP.string().datetime(),srcChainKey:n.ZP.array(n.ZP.string()).optional(),dstChainKey:n.ZP.array(n.ZP.string()).optional(),srcPool:n.ZP.array(n.ZP.string()).optional(),dstPool:n.ZP.array(n.ZP.string()).optional(),srcToken:n.ZP.array(n.ZP.string()).optional(),dstToken:n.ZP.array(n.ZP.string()).optional(),after:n.ZP.string().datetime().optional(),size:n.ZP.number().optional()}),w=n.ZP.object({data:n.ZP.object({usd:d,count:d})}),T=n.ZP.object({data:n.ZP.array(n.ZP.object({id:n.ZP.string(),chainKey:n.ZP.string(),address:n.ZP.string(),apr:d.nullish(),apy:d.nullish()}))});function F(){return{input:t=>({output:t=>({query:e=>async o=>{let a=await e({input:o});return t.parse(a)}})})}}let A=n.ZP.object({price:n.ZP.record(n.ZP.string(),n.ZP.number().nullable()),address:n.ZP.string().optional(),decimals:n.ZP.number(),chainKey:n.ZP.string(),name:n.ZP.string().optional(),icon:n.ZP.string().optional(),symbol:n.ZP.string()}),D={tokens:F().input(n.ZP.object({})).output(A.array()).query(async()=>(await r.Z.get("/api/tokens")).data),overview:{aggregated:{historical:F().input(p).output(c).query(async t=>{let{input:e}=t;return(await u.get("/overview/aggregated/historical",{params:e})).data}),live:F().input(n.ZP.object({})).output(v).query(async()=>(await u.get("/overview/aggregated/live")).data)},pool:{all:F().input(n.ZP.object({hydra:n.ZP.boolean().optional()})).output(m).query(async t=>{let{input:e}=t;return(await u.get("/overview/pools",{params:e})).data}),historical:F().input(P).output(g).query(async t=>{var e;let{input:{chainKey:o,address:a,sort:r}}=t;return null===(e=await u.get("/overview/pool/".concat(o,"/").concat(a,"/historical"),{params:{sort:r}}))||void 0===e?void 0:e.data}),live:F().input(h).output(y).query(async t=>{var e;let{input:{chainKey:o,address:a}}=t;return null===(e=await u.get("/overview/pool/".concat(o,"/").concat(a,"/live")))||void 0===e?void 0:e.data})},transfers:{all:F().input(f).output(Z).query(async t=>{var e;let{input:o}=t;return null===(e=await u.get("/overview/transfers",{params:o}))||void 0===e?void 0:e.data}),volume:F().input(b).output(w).query(async t=>{var e;let{input:o}=t;return null===(e=await u.get("/overview/transfers/volume",{params:o}))||void 0===e?void 0:e.data})},farm:{all:F().input(n.ZP.object({})).output(T).query(async t=>{var e;let{input:o}=t;return null===(e=await u.get("/overview/farms",{params:o}))||void 0===e?void 0:e.data})},stake:F().input(n.ZP.object({})).output(n.ZP.object({totalStgLocked:a.k1,totalVeStgSupply:a.k1,totalStgLockedRatio:n.ZP.string().transform(t=>{let e=(0,a.vz)(t,18);return new a.gG(e,1e18)}),globalAverageLockTime:n.ZP.number().positive()})).query(async()=>{let{data:t}=await r.Z.get("/api/stake/overview");return t})}}},10700:function(t,e,o){o.d(e,{T:function(){return a}});function a(t){return"".concat(t.chainKey,":").concat(t.address)}},15139:function(t,e,o){o.d(e,{b:function(){return s}});var a=o(47542),r=o(10700),n=o(59533);class i{getAdapter(t){let e=this.adapters.find(e=>e.supportsPool(t));if(e)return e;throw Error("Adapter not found for pool ".concat((0,r.T)(t)))}constructor(){this.adapters=a.S1,this.pools=a.Gm,(0,n.ky)(this,{},{autoBind:!0})}}let s=new i}}]);