"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4554],{3815:function(t,e,i){i.d(e,{A:function(){return u}});var n=i(27573),a=i(18703),r=i(19879);let s=(0,r.zo)(r.xu,{name:"ActionIcon"})(t=>{let{theme:e}=t;return{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,borderRadius:"100%",background:e.palette.background.field,border:"1px solid ".concat(e.palette.divider),position:"relative"}}),o=(0,r.zo)(a.J,{name:"ActionIcon-Icon"})(t=>{let{color:e="currentColor",size:i}=t;return{color:e,width:i||"initial",minWidth:i||"initial",height:i||"initial"}}),l=(0,r.zo)(r.xu,{name:"ActionIcon-Adornment"})(()=>({position:"absolute",bottom:0,right:0,display:"flex",alignItems:"center",justifyContent:"end",marginBottom:-4,marginRight:-4,"& > div":{"--gap":"6px",marginLeft:"calc(-1 * var(--gap))"},"& > div:nth-child(3)":{zIndex:1},"& > div:nth-child(2)":{zIndex:2},"& > div:nth-child(1)":{zIndex:3}})),u=t=>{let{type:e,iconSx:i,size:a=16,adornment:r}=t;return(0,n.jsxs)(s,{children:[(0,n.jsx)(o,{sx:i,type:e,size:a}),(0,n.jsx)(l,{children:r})]})}},35557:function(t,e,i){i.d(e,{e:function(){return l}});var n=i(27573),a=i(3815),r=i(99080),s=i(19879);let o=(0,s.zo)(s.xu,{name:"PlusSignIcon"})(t=>{let{theme:e}=t;return{width:12,height:12,borderRadius:"100%",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid ".concat(e.palette.background.paper),boxSizing:"content-box"}}),l=t=>{let{srcToken:e}=t;return(0,n.jsx)(a.A,{type:"checkmark",adornment:(0,n.jsx)(o,{children:(0,n.jsx)(r.r,{currency:e,size:12})})})}},99043:function(t,e,i){i.d(e,{a:function(){return u}});var n=i(27573),a=i(19879);let r=(0,a.zo)(a.xu,{name:"List",shouldForwardProp:t=>"size"!==t})(t=>{let{size:e}=t;return{display:"flex",flexDirection:"column",width:"100%",..."sm"===e&&{gap:8},..."md"===e&&{gap:12}}}),s=(0,a.zo)("div",{name:"ListItem",shouldForwardProp:t=>"size"!==t})(t=>{let{theme:e,size:i}=t;return{display:"flex",justifyContent:"space-between",..."sm"===i&&{...e.typography.p3},..."md"===i&&{...e.typography.p2}}}),o=(0,a.zo)("div",{name:"List-ItemKey"})(t=>{let{theme:e}=t;return{color:e.palette.text.secondary}}),l=(0,a.zo)("div",{name:"List-ItemValue"})(t=>{let{theme:e}=t;return{color:e.palette.text.primary}}),u=t=>{let{items:e,sx:i,size:a="md"}=t;return(0,n.jsx)(r,{sx:i,size:a,children:e.map((t,e)=>{let{key:i,label:r,value:u}=t;return(0,n.jsxs)(s,{size:a,children:[(0,n.jsx)(o,{children:null!=r?r:i}),(0,n.jsx)(l,{children:u})]},null!=i?i:e)})})}},49546:function(t,e,i){i.d(e,{N:function(){return o}});var n=i(27573),a=i(18703),r=i(19879);let s=(0,r.zo)(r.xu,{name:"IncreaseSignIcon"})(t=>{let{theme:e}=t;return{width:12,height:12,borderRadius:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:e.palette.info.dark,color:e.palette.info.main,border:"2px solid ".concat(e.palette.background.paper),boxSizing:"content-box"}}),o=()=>(0,n.jsx)(s,{children:(0,n.jsx)(a.J,{type:"arrow",size:12,sx:{transform:"rotate(-180deg)"}})})},35041:function(t,e,i){i.d(e,{A:function(){return o}});var n=i(27573),a=i(18703),r=i(19879);let s=(0,r.zo)(r.xu,{name:"MinusSignIcon"})(t=>{let{theme:e}=t;return{width:12,height:12,borderRadius:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:e.palette.error.dark,color:e.palette.error.main,border:"2px solid ".concat(e.palette.background.paper),boxSizing:"content-box"}}),o=()=>(0,n.jsx)(s,{children:(0,n.jsx)(a.J,{type:"minus",size:12})})},68103:function(t,e,i){i.d(e,{f:function(){return o}});var n=i(27573),a=i(18703),r=i(19879);let s=(0,r.zo)(r.xu,{name:"PlusSignIcon"})(t=>{let{theme:e}=t;return{width:12,height:12,borderRadius:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:e.palette.success.dark,color:e.palette.success.main,border:"2px solid ".concat(e.palette.background.paper),boxSizing:"content-box"}}),o=()=>(0,n.jsx)(s,{children:(0,n.jsx)(a.J,{type:"plus",size:8})})},79028:function(t,e,i){i.d(e,{I_:function(){return x},kT:function(){return C}});var n=i(6479),a=i(59533),r=i(5515),s=i(28066),o=i(50054),l=i(64770),u=i(15322);async function c(t,e){return(await e.signAndSubmit(await t)).wait()}var h=i(44506),d=i(3343),m=i(49509),g=i(82407),p=i(10983);let v=async()=>[{type:"renew"}],k=async()=>[{type:"stake"}],f=async()=>[{type:"unstake"}],y=async()=>[{type:"increaseLock"}],T=async()=>[{type:"stake"}],w=async()=>[{type:"stakeAndIncreaseLock"}];class x{get api(){let{item:t}=this;if(t)return this.stakeStore.apis.find(e=>e.supports(t.veToken))}get scenario(){let{item:t}=this,{balance:e}=t||{};if(!t||!e)return;let i={amount:this.amount,duration:this.duration};return this.canCreateLock?A(t,e,i):this.canWithdraw?S(t,e,i):this.canIncreaseLockAmount?b(t,e,i):void 0}get daysLeft(){let{unlockTime:t}=this;if(t)return function(t){if(void 0!==t)return Math.floor(t/86400)}(Math.max(t-(0,u.zB)(),0))}get errors(){var t;let e=[],{form:i}=this,{amount:n,maxAmount:a,item:r}=this,{minDuration:s,maxDuration:o}=null!==(t=this.scenario)&&void 0!==t?t:{},l=t=>e.push(t);return void 0===s||void 0===o||void 0===a||void 0===r?l("Loading ..."):(i.duration&&(i.duration<s&&l("Duration too short"),i.duration>o&&l("Duration too long")),this.canWithdraw?i.duration||l("Enter Duration"):this.hasStake?i.duration||i.amount||l("Enter Values"):i.duration&&i.amount||l("Enter Values"),(null==n?void 0:n.greaterThan(a))&&l("Insufficient balance")),e}get duration(){return this.form.duration}get amount(){var t;let e=null===(t=this.item)||void 0===t?void 0:t.stgToken;return(0,n.sp)(e,this.form.amount)}get isApproved(){return!0}get maxAmount(){var t;let{stgToken:e}=null!==(t=this.item)&&void 0!==t?t:{},{wallet:i}=this;if(e&&i)return this.balanceStore.getBalance(e,i.address)}get isWithdrawAndCreateLockApproved(){}get item(){return this.stakeStore.veItems.find(t=>t.id===this.form.id)}get lockTime(){var t;return null===(t=this.scenario)||void 0===t?void 0:t.lockTime}get unlockTime(){var t;return null===(t=this.scenario)||void 0===t?void 0:t.unlockTime}get votingPower(){var t;return null===(t=this.scenario)||void 0===t?void 0:t.votingPower}get lockedAmount(){var t;let{item:e,amount:i}=this,n=null==e?void 0:null===(t=e.balance)||void 0===t?void 0:t.lockedAmount;return i?null==n?void 0:n.add(i):n}get votingPowerAdded(){let{item:t,unlockTime:e,amount:i,canWithdraw:n,votingPower:a}=this,r=null==t?void 0:t.balance;if(!t||!e||!i||!r)return;if(n)return a;let s=r.amount;if(a&&s)return a.subtract(s)}get hasStake(){var t;let e=null===(t=this.item)||void 0===t?void 0:t.balance;return!!e&&e.lockedAmount.greaterThan(0)}get canWithdraw(){var t;if(!this.hasStake)return!1;let e=null===(t=this.item)||void 0===t?void 0:t.balance;return!!e&&e.lockEnd<=(0,u.zB)()}get canIncreaseLockAmount(){return this.hasStake}get canIncreaseUnlockTime(){var t,e,i,n,a;let r=null===(t=this.item)||void 0===t?void 0:t.balance;return!(!1===this.hasStake||!r||r.lockedAmount.equalTo(0)||r.lockEnd<(0,u.zB)())&&!((null!==(n=null===(e=this.scenario)||void 0===e?void 0:e.minDuration)&&void 0!==n?n:0)>=(null!==(a=null===(i=this.scenario)||void 0===i?void 0:i.maxDuration)&&void 0!==a?a:0))}get canCreateLock(){return!this.hasStake}get disabled(){return{amount:!1,duration:!1}}get isConfirming(){return!1}get wallet(){return l.walletStore.evm}addSteps(t){this.steps=[...t,...this.steps]}setId(t){this.form.id=t}setDuration(t){Number.isFinite(t=Math.floor(Number(t)))&&(this.disabled.duration&&(this.form.amount=""),this.form.duration=t)}setAmount(t){this.disabled.amount&&(this.form.duration=void 0),this.form.amount=t}setWeeks(t){let e=Math.floor(Number(t))*I;this.setDuration(e)}setMonths(t){var e;if(!this.item||(null===(e=this.scenario)||void 0===e?void 0:e.maxDuration)===void 0)return;let i=Math.floor(Math.round(Number(t)/12*31536e3)/I)*I;this.setDuration(Math.min(i,this.scenario.maxDuration))}setMaxDuration(){var t;let{maxDuration:e,minDuration:i}=null!==(t=this.scenario)&&void 0!==t?t:{};e&&i&&(e<i||this.setDuration(e))}setMaxAmount(){var t;let{stgBalance:e}=null!==(t=this.item)&&void 0!==t?t:{};if(!e)return;let i=e.toExact();i&&this.setAmount(i)}increase(){if(this.canWithdraw)return this.withdrawAndCreateLock();if(this.canCreateLock)return this.createLock();if(this.canIncreaseLockAmount&&this.canIncreaseUnlockTime&&this.form.duration&&this.form.amount)return this.increaseAmountAndTime();if(this.canIncreaseLockAmount&&this.form.amount)return this.increaseAmount();if(this.canIncreaseUnlockTime&&this.form.duration)return this.increaseUnlockTime();throw Error("Cannot increase")}reset(){this.form.amount="",this.form.duration=void 0}constructor(t){this.stakeStore=t,this.isApproving=!1,this.isDepositing=!1,this.isExecuting=!1,this.isWithdrawing=!1,this.form={id:"",amount:""},this.steps=[],this.balanceStore=o._,this.approve=(0,a.ls)(function*(t){this.isApproving=!0;try{let{api:e,wallet:i}=this;if(!e||!i||!t)return;let n=yield c(e.approve({amount:t}),i);s.actionStore.addAction(r.R.create({txHash:n.txHash,amount:t,createdTimestamp:(0,u.u3)()}))}finally{this.isApproving=!1}}),this.ensureApproved=(0,a.ls)(function*(){let{api:t,wallet:e,amount:i}=this;t&&e&&i&&(yield t.getAllowance(e.address)).lessThan(this.amount)&&(this.addSteps([{type:"approve"}]),yield this.approve(i))}),this.ensureWithdrawAndCreateLockApproved=(0,a.ls)(function*(){let{api:t,wallet:e,amount:i,lockedAmount:n}=this;if(!t||!e||!i||!n)return;let a=yield t.getAllowance(e.address),r=i.add(n);a.lessThan(r)&&(this.addSteps([{type:"approve"}]),yield this.approve(r))}),this.increaseAmountAndTime=(0,a.ls)(function*(){try{this.isExecuting=!0,this.steps=yield w(),yield this.ensureApproved();let{wallet:t}=this,{address:e,signer:i}=null!=t?t:{},{api:n,item:a,unlockTime:r,amount:o}=this,l=null==a?void 0:a.balance;if(!a||!e||!r||!l||!o||!n||!i||!t)return;yield t.switchChain(a.chainKey);let h={unlockTime:r,account:e,amount:o,chainKey:a.chainKey},d=yield c(n.increaseAmountAndTime(h),t);s.actionStore.addAction(m._.create({...h,txHash:d.txHash,createdTimestamp:(0,u.u3)()}))}finally{this.steps=[],this.isExecuting=!1}}),this.increaseAmount=(0,a.ls)(function*(){try{this.isExecuting=!0,this.isDepositing=!0,this.steps=yield T();let{api:t,item:e,unlockTime:i,amount:n,wallet:a}=this,{address:r}=null!=a?a:{},o=null==e?void 0:e.balance;if(!e||!r||!i||!o||!n||!t||!a)return;yield a.switchChain(e.chainKey),yield this.ensureApproved();let l={account:r,amount:n,chainKey:e.chainKey},h=yield c(t.increaseAmount(l),a);s.actionStore.addAction(d.i.create({...l,txHash:h.txHash,createdTimestamp:(0,u.u3)()}))}finally{this.steps=[],this.isExecuting=!1,this.isDepositing=!1}}),this.increaseUnlockTime=(0,a.ls)(function*(){try{this.isExecuting=!0,this.isDepositing=!0,this.steps=yield y();let{api:t,item:e,unlockTime:i,wallet:n}=this,{address:a}=null!=n?n:{},r=null==e?void 0:e.balance;if(!t||!e||!a||!i||!r||!n)return;yield n.switchChain(e.chainKey);let o={account:a,chainKey:e.chainKey,unlockTime:i},l=yield c(t.increaseUnlockTime(o),n);s.actionStore.addAction(g.Q.create({...o,txHash:l.txHash,createdTimestamp:(0,u.u3)()}))}finally{this.steps=[],this.isExecuting=!1,this.isDepositing=!1}}),this.withdraw=(0,a.ls)(function*(){try{this.isExecuting=!0,this.isWithdrawing=!0,this.steps=yield f();let{api:t,item:e,wallet:i}=this,{address:n}=null!=i?i:{};if(!t||!e||!n||!(null==e?void 0:e.lockedAmount)||!i)return;yield i.switchChain(e.chainKey);let a={chainKey:e.chainKey,account:n},r=yield c(t.withdraw(a),i);s.actionStore.addAction(p.z.create({...a,amount:e.lockedAmount,txHash:r.txHash,createdTimestamp:(0,u.u3)()}))}finally{this.steps=[],this.isExecuting=!1,this.isWithdrawing=!1}}),this.withdrawAndCreateLock=(0,a.ls)(function*(){try{var t;this.isExecuting=!0,this.isWithdrawing=!0,this.steps=yield v();let{api:e,item:i,unlockTime:n,amount:a,wallet:r}=this,{address:o}=null!=r?r:{},l=null==i?void 0:i.balance;if(!e||!i||!o||!n||!l||!r)return;yield r.switchChain(i.chainKey),yield this.ensureWithdrawAndCreateLockApproved();let d=null==i?void 0:null===(t=i.balance)||void 0===t?void 0:t.lockedAmount;if(!d)return;let m=a?d.add(a):d,g={chainKey:i.chainKey,amount:m,account:o,unlockTime:n},k=yield c(e.withdrawAndCreateLock(g),r);s.actionStore.addAction(h.D.create({...g,amount:m,txHash:k.txHash,createdTimestamp:(0,u.u3)()})),s.actionStore.addAction(p.z.create({...g,amount:d,txHash:k.txHash,createdTimestamp:(0,u.u3)()}))}finally{this.steps=[],this.isExecuting=!1,this.isWithdrawing=!1}}),this.createLock=(0,a.ls)(function*(){try{this.isExecuting=!0,this.isDepositing=!0,this.steps=yield k(),yield this.ensureApproved();let{api:t,item:e,unlockTime:i,amount:n,wallet:a}=this,{address:r}=null!=a?a:{};if(!t||!e||!r||!i||!n||!a)return;yield a.switchChain(e.chainKey);let o={chainKey:e.chainKey,amount:n,account:r,unlockTime:i},l=yield c(t.createLock(o),a);s.actionStore.addAction(h.D.create({...o,txHash:l.txHash,createdTimestamp:(0,u.u3)()}))}finally{this.steps=[],this.isExecuting=!1,this.isDepositing=!1}}),(0,a.ky)(this,{},{autoBind:!0})}}let A=(t,e,i)=>({get minDuration(){return B},get maxDuration(){return t.maxTime},get lockTime(){return(0,u.zB)()},get unlockTime(){if(!i.duration)return;let e=Math.min(E()+i.duration,(0,u.zB)()+t.maxTime);return t.entity.getUnlockTime(e)},get votingPower(){if(!i.amount||!i.duration||!this.unlockTime)return n.ih.fromRawAmount(t.veToken,0);return t.entity.estimateVeWithTs(i.amount,(0,u.zB)(),this.unlockTime)}}),S=(t,e,i)=>({get minDuration(){return B},get maxDuration(){return t.maxTime},get lockTime(){return(0,u.zB)()},get unlockTime(){if(!i.duration)return e.lockEnd;let n=Math.min(E()+i.duration,(0,u.zB)()+t.maxTime);return t.entity.getUnlockTime(n)},get votingPower(){let n=i.amount?e.lockedAmount.add(i.amount):e.lockedAmount;return t.entity.estimateVeWithTs(n,(0,u.zB)(),this.unlockTime)}}),b=(t,e,i)=>({get minDuration(){return I},get maxDuration(){let i=e.lockEnd,n=(0,u.zB)();return Math.floor((n+t.maxTime-Math.max(i,n))/B)*B},get lockTime(){return},get unlockTime(){if(!i.duration)return e.lockEnd;let n=Math.min(e.lockEnd+i.duration,(0,u.zB)()+t.maxTime);return t.entity.getUnlockTime(n)},get votingPower(){let n=i.amount?e.lockedAmount.add(i.amount):e.lockedAmount;return t.entity.estimateVeWithTs(n,(0,u.zB)(),this.unlockTime)}}),I=604800,B=2419200;function E(){return(Math.floor((0,u.zB)()/I)+1)*I}function C(t){return Math.round(t/31536e3*12)}},84047:function(t,e,i){i.d(e,{m:function(){return c},h:function(){return u}});var n=i(4986),a=i(59533),r=i(50054),s=i(64770),o=i(15322);class l{get amount(){return r._.getBalance(this.veToken,this.account)}get canWithdraw(){return this.lockEnd<=(0,o.zB)()}constructor(t,e,i,n,a){this.veToken=t,this.chainKey=e,this.lockedAmount=i,this.account=n,this.lockEnd=a}}let u="19.49%";class c{get items(){return[this.sveItem,...this.veItems].flatMap(t=>t?[t]:[])}get account(){var t;return null===(t=s.walletStore.evm)||void 0===t?void 0:t.address}get myStakes(){return this.veItems.filter(t=>t.hasLockedStg)}get availableStakes(){return this.veItems.filter(t=>{var e;return null===(e=t.stgBalance)||void 0===e?void 0:e.greaterThan(0)})}get totalStakedNetworkCount(){return(0,n.Z)(this.availableStakes,"chainKey").length}async updateBalances(){let{account:t}=this;if(t)return Promise.all([...this.veItems.map(e=>this.balanceStore.updateBalance(e.stgToken,t)),...this.items.map(e=>this.balanceStore.updateBalance(e.veToken,t)),...this.items.map(t=>this.updateItemBalance(t)),...this.items.map(t=>this.updateItemTotalSupply(t))])}async updateItemTotalSupply(t){let e=this.apis.find(e=>e.supports(t.veToken));if(!e)return;let i=await e.getTotalSupply({veToken:t.veToken});(0,a.z)(()=>{t.veSupply=i})}setTotalCirculatingSupply(t){this.totalCirculatingSupply=t}subscribe(){let t=()=>{let{items:t,account:e}=this;this.updateBalances()},e=[(0,a.EH)(()=>t())];return()=>e.forEach(t=>t())}constructor(t,e,i=[],n=[]){this.veItems=[],this.sveItem=void 0,this.aastgItem=void 0,this.balances=new Map,this.apis=[],this.balanceStore=r._,this.updateItemBalance=(0,a.ls)(function*(t){let{account:e}=this,{veToken:i}=t,n=this.apis.find(e=>e.supports(t.veToken));if(!e||!n)return;let r=yield n.getBalance({veToken:t.veToken,account:e});(0,a.z)(()=>{t.balance=new l(i,i.chainKey,r.lockedAmount,e,r.lockEnd)})}),this.aastgItem=t,this.sveItem=e,this.veItems=i,this.apis=n,(0,a.ky)(this,{},{autoBind:!0})}}},5759:function(t,e,i){i.d(e,{stakeAddStore:function(){return F},stakeOverviewStore:function(){return R},U:function(){return H},stakeStore:function(){return W}});var n=i(81735),a=i(49808),r=i(6479),s=i(35440),o=i(51436);class l{supports(t){var e;return this.config.veToken.equals(t)||(null===(e=this.config.sveToken)||void 0===e?void 0:e.equals(t))||!1}async approve(t){let{amount:e}=t,{veToken:i}=this.config;return await this.erc20.forToken(this.config.stgToken).approve(e,i.address)}async getAllowance(t){let{veToken:e}=this.config;return await this.erc20.forToken(this.config.stgToken).allowance(t,e.address)}async createLock(t){let{chainKey:e}=t,i=this.votingEscrowContract.populateTransaction.create_lock(t.amount.toBigInt(),t.unlockTime);return(0,s._X)(i,{provider:this.providerFactory(e),chainKey:e})}async increaseAmountAndTime(t){let e=this.votingEscrowContract.populateTransaction.increase_amount_and_time(t.amount.toBigInt(),t.unlockTime);return(0,s._X)(e,{provider:this.providerFactory(t.chainKey),chainKey:t.chainKey})}async increaseAmount(t){let{chainKey:e}=t,i=this.votingEscrowContract.populateTransaction.increase_amount(t.amount.toBigInt());return(0,s._X)(i,{provider:this.providerFactory(e),chainKey:e})}async increaseUnlockTime(t){let{chainKey:e}=t,i=this.votingEscrowContract.populateTransaction.increase_unlock_time(t.unlockTime);return(0,s._X)(i,{provider:this.providerFactory(e),chainKey:e})}async withdraw(t){let{chainKey:e}=t,i=this.votingEscrowContract.populateTransaction.withdraw();return(0,s._X)(i,{provider:this.providerFactory(e),chainKey:e})}async withdrawAndCreateLock(t){let{chainKey:e,amount:i}=t,n=this.votingEscrowContract.populateTransaction.withdraw_and_create_lock(i.toBigInt(),t.unlockTime);return(0,s._X)(n,{provider:this.providerFactory(e),chainKey:e})}async getBalance(t){(0,r.hu)((0,r.hD)(t.veToken),"veToken must be a token");let e=await this.votingEscrowContract.attach(t.veToken.address).locked(t.account);return{lockedAmount:r.ih.fromBigInt(this.config.stgToken,e.amount.toBigInt()),lockEnd:e.end.toNumber()}}async getTotalSupply(t){let{veToken:e}=t,i=this.erc20.forToken(e),n=await i.totalSupply();return r.ih.fromBigInt(e,n.toBigInt())}constructor(t,e,i){this.config=t,this.providerFactory=e,this.erc20=i,this.votingEscrowContract=o.PN.connect(t.veToken.address,e(t.veToken.chainKey))}}var u=i(59533),c=i(50054),h=i(64770),d=i(15322);let m=new r.gG(1,1);class g{toSTG(t){(0,r.hu)(t.token.equals(this.aastgToken));let e=this.aastgToken;return r.ih.fromRawAmount(e,t.quotient).multiply(4e12)}getWalletBalance(t){let e=h.walletStore.active.find(t=>"evm"===t.chainType);if(e)return c._.getBalance(t,e.address)}get vestingStartDate(){return new Date(1e3*this.vestingStart)}get vestingEndDate(){return new Date(1e3*this.vestingEnd)}get vestingEnd(){return this.vestingStart+this.vestingDuration}get chainKey(){return this.aastgToken.chainKey}get wallet(){return h.walletStore.active.find(t=>"evm"===t.chainType)}get auctionAmount(){let t=this.getWalletBalance(this.aastgToken);if(t)return this.toSTG(r.ih.fromBigInt(this.aastgToken,t.quotient))}get redeemedAmount(){var t;let e=null===(t=this.wallet)||void 0===t?void 0:t.address;if(!e)return;let i=this.redeemedShares.get(e);if(i)return this.toSTG(i)}get vestingProgress(){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,d.zB)(),e=Math.max(t-1679155200,0);return e>15724800?m:new r.gG(e,15724800)}((0,d.zB)())}get unlockedAmount(){let{auctionAmount:t}=this;if(t)return t.multiply(this.vestingProgress)}get lockedAmount(){let{unlockedAmount:t,auctionAmount:e}=this;if(e&&t)return e.subtract(t)}get redeemableAmount(){let{unlockedAmount:t,redeemedAmount:e}=this;if(e&&t)return e.greaterThan(t)?t.multiply(0):t.subtract(e)}constructor(t){this.vestingStart=1679155200,this.vestingDuration=15724800,this.isExecuting=!1,this.isSigning=!1,this.redeemedShares=new Map,this.redeem=(0,u.ls)(function*(){try{this.isExecuting=!0;let{redeemableAmount:t,wallet:e}=this;(0,r.hu)(t),(0,r.hu)(e),yield e.switchChain(this.chainKey);let i=e.signer,n=e.address;(0,r.hu)(n);let a=this.whitelistAuction.connect(i);this.isSigning=!0;let s=yield a.redeem();this.isSigning=!1;let{transactionHash:o}=yield s.wait()}finally{this.isExecuting=!1,this.isSigning=!1,this.updateRedeemed()}}),this.updateRedeemed=(0,u.ls)(function*(){var t;let e=null===(t=this.wallet)||void 0===t?void 0:t.address;(0,r.hu)(e);let i=yield this.whitelistAuction.redeemedShares(e),n=r.ih.fromBigInt(this.aastgToken,i.toBigInt());this.redeemedShares.set(e,n)}),(0,u.ky)(this,{},{autoBind:!0}),this.aastgToken=t.aastgToken,this.stgToken=t.stgToken,this.whitelistAuction=t.whitelistAuction}}class p{get chainKey(){return this.stgToken.chainKey}get id(){return this.chainKey}get stgBalance(){var t;let{address:e}=null!==(t=h.walletStore.evm)&&void 0!==t?t:{};if(e)return c._.getBalance(this.stgToken,e)}constructor(t,e){this.veSupply=void 0,this.balance=void 0,this.veToken=t,this.stgToken=e,(0,u.rC)(this,{chainKey:u.Fl,balance:u.LO.struct,veSupply:u.LO.struct,stgBalance:u.Fl.struct},{autoBind:!0})}}class v extends p{get id(){return"svestg"}get vestingProgress(){return new r.gG(1,1)}get lockedAmount(){var t;return null===(t=this.balance)||void 0===t?void 0:t.lockedAmount}}let k=BigInt(94608e3);class f{estimateVe(t,e){(0,r.hu)(t.token.equals(this.token),"TOKEN");let i=e;e<0&&(i=0);let n=t.divide(BigInt(k)).multiply(BigInt(i));return r.ih.fromFractionalAmount(this.veToken,n.numerator,n.denominator)}estimateVeWithTs(t,e,i){return this.estimateVe(t,i-e)}getUnlockTime(t){return 604800*Math.floor(t/604800)}constructor(t,e){this.token=t,this.veToken=e}}class y extends p{get entity(){return new f(this.stgToken,this.veToken)}get hasLockedStg(){var t,e;return null!==(e=null===(t=this.lockedAmount)||void 0===t?void 0:t.greaterThan(0))&&void 0!==e&&e}get lockedAmount(){var t;return null===(t=this.balance)||void 0===t?void 0:t.lockedAmount}constructor(t,e,i,n){super(t,e),this.minTime=i,this.maxTime=n}}var T=i(70491);let w=n.e,{auction:x,sveItem:A,veItems:S}=function(t){let e,i;let n=[];for(let a in t.deployments){let r=t.deployments[a];if(r.aastgToken){if(i)throw Error("Multiple auctions not supported");i=new g({whitelistAuction:o.PK.connect(r.aastgToken.address,(0,T.I)(a)),stgToken:r.stgToken,aastgToken:r.aastgToken})}if(r.sveToken){if(e)throw Error("Multiple SVE items not supported");e=new v(r.sveToken,r.stgToken)}n.push(new y(r.veToken,r.stgToken,r.minTime,r.maxTime))}return{sveItem:e,veItems:n,auction:i}}(w),b=function(t){let e=[];for(let i in t.deployments){let n=new l(t.deployments[i],T.I,a.m);e.push(n)}return e}(w);var I=i(23974);let B=function(t){if("mainnet"===t)return x}(I.O.NEXT_PUBLIC_STAGE),E="mainnet"===I.O.NEXT_PUBLIC_STAGE?S:[],C=function(t){if("mainnet"===t)return A}(I.O.NEXT_PUBLIC_STAGE),z="mainnet"===I.O.NEXT_PUBLIC_STAGE?b:[];var D=i(79028);class K{get veTotalSupply(){var t;let e=null===(t=this.stakeStore.sveItem)||void 0===t?void 0:t.veSupply,i=L(this.stakeStore.veItems.map(t=>t.veSupply).flatMap(t=>t?[t]:[]));return L([e,i])}get myTotalAvailableStg(){return L(this.stakeStore.veItems.map(t=>t.stgBalance).flatMap(t=>t?[t]:[]))}get myStgLocked(){return L(this.stakeStore.items.map(t=>{var e;return null===(e=t.balance)||void 0===e?void 0:e.lockedAmount}).flatMap(t=>t?[t]:[]))}get myVeBalance(){return L(this.stakeStore.veItems.map(t=>{var e;return null===(e=t.balance)||void 0===e?void 0:e.amount}).flatMap(t=>t?[t]:[]))}get myAvgLockTime(){let{myVeBalance:t,myStgLocked:e}=this;if(t&&e)return Number.parseFloat(t.toExact())/Number.parseFloat(e.toExact())*_}get myVotingPower(){let t=this.veTotalSupply,e=this.myVeBalance;if(t&&e)return new r.gG(e.toBigInt(),t.toBigInt())}constructor(t){this.stakeStore=t,(0,u.ky)(this,{},{autoBind:!0})}}function L(t,e){if(0===t.length||t.some(t=>!t))return;e=t[0].token;let i=t.reduce((t,e)=>e?t+Number.parseFloat(e.toExact()):t,0);return(0,r.sp)(e,i.toFixed(e.decimals))}let _=94608e3;var j=i(47542),M=i(28066),P=i(26686);class N{addFeeDistributor(t){this.adapters.push(t)}get wallet(){return h.walletStore.evm}get isSwitchingChain(){var t;return null===(t=this.wallet)||void 0===t?void 0:t.isSwitchingChain}updatePendingRewards(){if(this.wallet)for(let t of this.adapters)t.getPendingRewards(this.wallet.address).then(()=>{})}async claim(t){if(this.isClaiming)throw Error("Already claiming");let e=this.adapters.find(e=>e.supportsClaim(t)),i=this.wallet;(0,r.hu)(e,"No adapter found for reward"),(0,r.hu)(i,"No wallet found");try{this.stakingReward=t,this.isClaiming=!0,await i.switchChain(t.rewardDistributor.chainKey);let n=await e.claim(t);(0,u.z)(()=>{this.isSigning=!0});let a=await i.signAndSubmit(n);(0,u.z)(()=>{this.isSigning=!1,this.isConfirming=!0});let r=await a.wait();M.actionStore.addAction(P.h.create({chainKey:t.rewardDistributor.chainKey,txHash:r.txHash,createdTimestamp:(0,d.u3)(),rewards:t.pendingRewards,user:t.user}))}finally{this.updatePendingRewards(),(0,u.z)(()=>{this.isSigning=!1,this.isConfirming=!1,this.isClaiming=!1,this.stakingReward=void 0})}}subscribe(){}constructor(){this.isConfirming=!1,this.isClaiming=!1,this.isSigning=!1,this.adapters=j.Sl,this.stakingReward=void 0,(0,u.ky)(this,{stakingReward:u.LO.ref},{autoBind:!0})}}let W=new(i(84047)).m(B,C,E,z),F=new D.I_(W),H=new N,R=new K(W)},59430:function(t,e,i){i.d(e,{h:function(){return s}});var n=i(27573),a=i(3815),r=i(68103);let s=t=>{let{isPending:e}=t;return(0,n.jsx)(a.A,{type:"stake",adornment:(0,n.jsx)(r.f,{}),iconSx:{opacity:()=>e?.5:1}})}},5907:function(t,e,i){i.d(e,{g:function(){return o}});var n=i(27573),a=i(3815),r=i(49546),s=i(68103);let o=()=>(0,n.jsx)(a.A,{type:"stake",adornment:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.N,{}),(0,n.jsx)(s.f,{})]})})},25845:function(t,e,i){i.d(e,{s:function(){return s}});var n=i(27573),a=i(3815),r=i(49546);let s=()=>(0,n.jsx)(a.A,{type:"stake",adornment:(0,n.jsx)(r.N,{})})},59236:function(t,e,i){i.d(e,{V:function(){return s}});var n=i(27573),a=i(3815),r=i(35041);let s=()=>(0,n.jsx)(a.A,{type:"stake",adornment:(0,n.jsx)(r.A,{})})}}]);